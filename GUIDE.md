# LazyVim & Go 开发新手指南 (已更新)

## 1. 快速开始一个 Go 项目
如果你想测试环境是否配置成功，请按以下步骤操作：

1.  **打开文件夹**：在终端进入一个空目录，输入 `nvim .`。
2.  **创建文件**：按 `<leader> e` 打开侧边栏，按 `a` 创建 `main.go`。
3.  **初始化项目**：按 `<leader> f t` 打开终端，输入：
    ```bash
    go mod init myproject
    ```
4.  **编写代码**：在 `main.go` 中输入 `func main() { fmt.Println("hello") }`。
### 方法 A：通过快捷键 (最快)
- **`<leader> g r`**: 运行整个项目 (`go run .`)。
- **`<leader> g f`**: 运行当前文件 (`go run main.go`)。
  *运行后，终端会保持开启，方便看输出。按 `Esc Esc` 进入 Normal 模式，再按 `q` 或输入 `exit` 即可关闭。*

### 方法 B：通过内置终端 (手动)
1.  按 `<leader> f t` 打开终端。
2.  输入 `go run .` 并回车。

---

## 2. 运行测试 (关键步骤)
如果 `<leader> t t` 无反应，请检查：

1.  **文件名格式**：必须是 `xxx_test.go` (例如 `hello_test.go`)。
2.  **代码示例**：确保文件内有标准的测试函数：
    ```go
    func TestDemo(t *testing.T) {
        if 1 + 1 != 2 { t.Error("Fail") }
    }
    ```
3.  **等待插件加载**：第一次打开测试文件时，观察右下角，LazyVim 可能会自动启动 `gopls`。等它启动完成后，按 `<leader> t t`。
4.  **查看结果**：如果测试运行了，会弹出一个浮窗显示测试进度。

---

## 3. 常用快捷键清单

### 文件管理
- `<leader> e`: 打开/关闭文件树 (Snacks Explorer)。
- **`.` (在文件树中)**: 切换显示/隐藏 **隐藏文件**。
- **`H` (在文件树中)**: 切换显示/隐藏 **被忽略文件** (git ignore)。
- `<leader> f f`: 查找文件 (Find Files)。

### 代码开发
- `<leader> c a`: **Code Action** (最强功能：自动导包、填充结构体、错误处理)。
- `g d`: 跳转到定义。
- `g r`: 查看引用。
- `<leader> c r`: 重命名。

### 运行与调试
- `<leader> t t`: 运行当前测试 (Run Nearest Test)。
- `<leader> t f`: 运行当前文件的所有测试。
- `<leader> d b`: 打断点。
- `<leader> d c`: 开始调试。

---

## 4. 常见问题排查
- **快捷键没反应？** 按下 `<leader>` (空格) 后停顿 1 秒，下方会弹出菜单，你可以手动查看 `t` (test) 目录下有哪些可用的命令。
- **图标乱码？** 必须在终端设置中安装并使用 **Nerd Font**。
- **搜不到文件？** 确保在终端安装了 `brew install ripgrep fd`。

---

## 8. 终极工作流增强 (Ultimate Enhancements)

你的环境已经过深度定制，以下是专属你的高级功能说明：

### A. macOS 输入法自动切换
- **功能**: 当你按 `Esc` 离开插入模式时，系统会自动将输入法切回 **ABC (英文)**。
- **配置位置**: `lua/plugins/im-select.lua` (基于 `im-select` 命令行工具)。
- **优点**: 异步处理，零延迟。防止在普通模式下输入命令变成打字。

### B. Neovide GUI 增强
如果你使用 Neovide 启动：
- **快捷键**:
  - `Command + S`: 快速保存。
  - `Command + W`: 快速关闭当前标签页。
  - `Command + 1-9`: 快速跳转到标签页。
  - `Command + Z / Shift+Z`: 撤销/重做。
  - `Command + A`: 全选。
  - `Command + C / V`: 完美兼容系统剪贴板。
  - `Command + Q`: 快速退出。
- **视觉**: 开启了透明度 (0.95)、光标拖尾动画和平滑滚动。
- **配置位置**: `lua/config/neovide.lua`。

### C. AI 补全 (Supermaven)
- **快捷键**:
  - `<Tab>`: 接受 AI 建议。
  - `Ctrl + j`: 接受建议中的下一个单词。
  - `Ctrl + ]`: 清除当前建议。
- **状态检查**: 输入 `:SupermavenStatus` 查看运行情况。

### D. 快速运行 Go 代码
- **`<leader> g r`**: 运行整个项目 (`go run .`)。
- **`<leader> g f`**: 运行当前单个文件。

### E. 测试与排查总结
- **`<leader> t t`**: 运行光标所在测试函数（需安装 `delve`）。
- **同步插件**: 如果功能缺失，运行 `:Lazy sync`。
- **查看大纲**: 按 `<leader> s s` 搜索当前文件的符号。

---

## 9. 极速键位与效率秘籍 (Efficiency Hacks)
要比 IDE 更快，你需要改变操作习惯。以下是已为你配置好的“开挂”功能：

### A. 必背的新快捷键
- **`jj` (在插入模式)**: 秒退回 Normal 模式。
- **`Ctrl + s`**: 随时保存文件。
- **`Shift + Enter` (在插入模式)**: **向上开启新行** (不打断打字)。
- **`Ctrl + Enter` (在插入模式)**: **向下开启新行**。
- **`Enter` (在 Normal 模式)**: 向下开启新行 (代替 o)。
- **`<leader>h` / `<leader>l`**: 跳到行首 / 行尾。
- **精简模式**: 已禁用 `a, o, O`，请使用 `i`、`I`、`A` 或回车。
- **`Ctrl + d / u`**: 向下/向上翻半页。

### B. "瞬移" (Flash.nvim) - 杀手级功能
别再按 `j` `j` `j` 或者用鼠标去点某一行了。
1.  **按 `s`**。
2.  输入你想去的那个单词的前两个字母（比如 `fu`）。
3.  屏幕上会跳出一些**黄色字母标签**。
4.  按下对应的字母，光标直接飞过去。

### C. 注释操作 (Commenting)
- **`gcc`**: 注释/取消注释当前行。
- **`gc` (Visual模式)**: 注释选中的多行。
- **`gcap`**: 注释整个代码块/段落。

### F. 原生多行编辑 (Visual Block)
当你需要对齐或批量修改多行开头/结尾时：
1.  **`Ctrl + v`**: 进入块选择模式，用 `j/k` 选中多行。
2.  **`I` (大写 i)**: 在选中的列**前**插入内容。
3.  **`A` (大写 A)**: 在选中的列**后**追加内容。
4.  **`c` (小写 c)**: **修改/替换** 选中的整个矩形块。
5.  **输入内容**，完成后按 **两次 `Esc`**。
    - *你会发现输入的内容会瞬间应用到所有选中的行！*

### D. "动词 + 名词" (文本对象)工具
这是 Vim 的灵魂。不要一个个字符删，要按结构改。
- **`ci"` (Change Inner Quote)**: 修改引号里的内容。
    - 场景: `fmt.Println("Hello")` -> 光标在引号内按 `ci"` -> 变成 `fmt.Println("|")` 并进入插入模式。
- **`ci(`**: 修改括号里的内容。
- **`da{` (Delete Around Braces)**: 删除整个花括号代码块 (包括花括号本身)。
- **`yiw` (Yank Inner Word)**: 复制当前单词。

### D. "包裹" (Mini.surround)
- **`gsa" ` (Add quotes)**: 给当前单词加上引号。
    - 场景: `hello` -> 光标在单词上按 `gsa"` -> `"hello"`
- **`gsd" ` (Delete quotes)**: 删除周围的引号。

### E. 搜索与替换 (Search & Replace)
- **`/keyword`**: 向上查找内容 (按 `n` 下一个)。
- **`:%s/old/new/g`**: 全文件替换内容。
- **`:%s/old/new/gc`**: 全文件替换并逐个手动确认。
- **`<leader>sr`**: **全局替换面板** (用于在整个项目中批量改代码)。
- **`F2` (或 `<leader>cr`)**: **智能重命名** (Go 变量/函数专用，最安全)。

祝你的 Go 开发效率翻倍！
